name: Linux GCC/Clang Qt5.15

on:
  pull_request:
  push:
    branches:
      - main
      - gh-actions

jobs:

  build:
    name: cmake build / ctest

    runs-on: ubuntu-20.04

    strategy:
      matrix:
        compiler:
          - key: clang14
            apt: [ clang-14, lld, g++-11 ]
            command: clang++-14

          - key: gcc11
            apt: [ g++-11 ]
            command: g++-11

    steps:
    - uses: actions/checkout@v3

    - name: vcpkg upgrade
      run: |
        pwd
        cd "$VCPKG_INSTALLATION_ROOT"
        echo $VCPKG_INSTALLATION_ROOT
        pwd
        git pull
        vcpkg update
        vcpkg upgrade
        vcpkg upgrade --no-dry-run
